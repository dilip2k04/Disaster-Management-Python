{% extends "base.html" %}
{% block content %}

<style>
:root{
 --primary:#1e293b;
 --accent:#2563eb;
 --secondary:#dc2626;
 --success:#16a34a;
 --bg:#f1f5f9;
}

body{
 background:var(--bg);
}

/* container */
.container{
 max-width:1250px;
 margin:auto;
 padding:40px 20px;
}

/* heading */
.page-title{
 font-size:28px;
 font-weight:700;
 margin-bottom:25px;
 color:var(--primary);
 display:flex;
 align-items:center;
 gap:10px;
}

/* tabs */
.tabs{
 display:flex;
 gap:15px;
 margin-bottom:30px;
}

.tab{
 padding:10px 22px;
 background:#e2e8f0;
 border-radius:8px;
 font-weight:600;
 cursor:pointer;
 transition:.25s;
}

.tab.active{
 background:var(--accent);
 color:white;
}

.tab-content{display:none}
.tab-content.active{display:block}

/* cards grid */
.missing-persons-grid{
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(320px,1fr));
 gap:25px;
}

/* card */
.person-card{
 background:white;
 border-radius:14px;
 overflow:hidden;
 box-shadow:0 8px 20px rgba(0,0,0,.08);
 transition:.25s;
 display:flex;
 flex-direction:column;
}

.person-card:hover{
 transform:translateY(-6px);
 box-shadow:0 12px 25px rgba(0,0,0,.12);
}

/* image */
.person-image{
 height:240px;
 background-size:cover;
 background-position:center;
 position:relative;
}

/* top badges */
.badges{
 position:absolute;
 top:10px;
 left:10px;
 display:flex;
 gap:6px;
}

.badge{
 background:rgba(0,0,0,.75);
 color:white;
 font-size:12px;
 padding:4px 8px;
 border-radius:6px;
}

/* details */
.person-details{
 padding:18px;
 display:flex;
 flex-direction:column;
 gap:8px;
}

.person-details h4{
 font-size:18px;
 font-weight:700;
}

.info{
 font-size:14px;
 color:#475569;
}

.section-label{
 font-weight:600;
 color:#334155;
 font-size:13px;
 margin-top:6px;
}

.contact{
 margin-top:8px;
 background:#e0f2fe;
 padding:8px;
 border-radius:6px;
 font-size:13px;
 color:#0369a1;
}

/* report form */
.search-section{
 background:white;
 padding:28px;
 border-radius:14px;
 box-shadow:0 8px 20px rgba(0,0,0,.08);
}

form{
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
 gap:14px;
}

textarea{
 grid-column:1/-1;
}

input,select,textarea{
 padding:10px;
 border-radius:8px;
 border:1px solid #e2e8f0;
 font-size:14px;
}

/* buttons */
.btn{
 background:var(--accent);
 color:white;
 border:none;
 padding:11px 20px;
 border-radius:8px;
 font-weight:600;
 cursor:pointer;
}

.btn-secondary{
 background:var(--secondary);
}

.submit-btn{
 grid-column:1/-1;
}

.flash{
 background:#dcfce7;
 color:#065f46;
 padding:10px;
 border-radius:8px;
 margin-bottom:20px;
}

</style>


<div class="container">

<h2 class="page-title">ðŸ”Ž Missing Persons Registry</h2>

{% with messages = get_flashed_messages() %}
{% if messages %}
<div class="flash">{{ messages[0] }}</div>
{% endif %}
{% endwith %}

<div class="tabs">
  <div class="tab active" data-tab="list">Search Missing</div>
  <div class="tab" data-tab="report">Report Missing</div>
</div>


<!-- ================= LIST ================= -->
<div class="tab-content active" id="list">

<div class="missing-persons-grid">

{% for p in persons %}
<div class="person-card">

  <div class="person-image"
       style="background-image:url('{{ p.photo_url or url_for('static', filename='no-image.png') }}')">

      <div class="badges">
        <span class="badge">{{ p.age }} yrs</span>
        <span class="badge">{{ p.gender }}</span>
      </div>
  </div>

  <div class="person-details">

      <h4>{{ p.name }}</h4>

      <div class="info"><b>Last Seen:</b> {{ p.location }}</div>
      <div class="info"><b>Date:</b> {{ p.date_seen }}</div>

      <div class="section-label">Description</div>
      <div class="info">{{ p.description }}</div>

      {% if p.notes %}
      <div class="section-label">Additional Notes</div>
      <div class="info">{{ p.notes }}</div>
      {% endif %}

      <div class="contact">
        ðŸ“ž {{ p.reporter_name }} | {{ p.reporter_contact }}
        <br>
        Relation: {{ p.reporter_relation }}
      </div>

  </div>

</div>
{% else %}
<p>No reports yet.</p>
{% endfor %}

</div>
</div>



<!-- ================= REPORT FORM ================= -->
<div class="tab-content" id="report">

<div class="search-section">

<h3 style="margin-bottom:15px">Report a Missing Person</h3>

<form method="POST"
      action="/report-missing"
      enctype="multipart/form-data">

<input name="name" placeholder="Full Name" required>
<input name="age" type="number" placeholder="Age" required>

<select name="gender" required>
<option value="">Gender</option>
<option>Male</option>
<option>Female</option>
<option>Other</option>
</select>

<input name="location" placeholder="Last Known Location" required>
<input name="date" type="date" required>

<textarea name="description" placeholder="Physical Description" required></textarea>

<textarea name="notes" placeholder="Additional Notes"></textarea>

<input type="file" name="photo" accept="image/*">

<input name="reporter_name" placeholder="Your Name" required>
<input name="reporter_contact" placeholder="Phone or Email" required>
<input name="reporter_relation" placeholder="Relationship" required>

<button class="btn btn-secondary submit-btn">Submit Report</button>

</form>

</div>
</div>

</div>


<script>
const tabs=document.querySelectorAll('.tab');
const contents=document.querySelectorAll('.tab-content');

tabs.forEach(t=>{
 t.onclick=()=>{
  tabs.forEach(x=>x.classList.remove('active'));
  contents.forEach(c=>c.classList.remove('active'));
  t.classList.add('active');
  document.getElementById(t.dataset.tab).classList.add('active');
 }
});
</script>

{% endblock %}
