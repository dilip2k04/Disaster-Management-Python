{% extends "base.html" %}

{% block content %}
<style>
  body {
    margin: 0;
    padding: 0;
    background: #0f172a;
    font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  .creative-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    min-height: 100vh;
    position: relative;
  }

  .creative-visual {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    position: relative;
    overflow: hidden;
    padding: 60px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
  }

  .visual-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      radial-gradient(circle at 20% 80%, rgba(37, 99, 235, 0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(236, 72, 153, 0.15) 0%, transparent 50%);
    animation: pulse 8s ease-in-out infinite alternate;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
  }

  .visual-content {
    position: relative;
    z-index: 2;
    max-width: 500px;
  }

  .visual-title {
    font-size: 48px;
    font-weight: 800;
    background: linear-gradient(135deg, #60a5fa, #a855f7);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 20px;
    line-height: 1.2;
    letter-spacing: -0.5px;
  }

  .visual-subtitle {
    font-size: 20px;
    color: #cbd5e1;
    margin-bottom: 40px;
    line-height: 1.6;
  }

  .features-list {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-top: 40px;
  }

  .feature-item {
    display: flex;
    align-items: center;
    gap: 15px;
    color: #e2e8f0;
    font-size: 16px;
    padding: 15px 20px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
  }

  .feature-item:hover {
    transform: translateX(10px);
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.2);
  }

  .feature-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #2563eb, #7c3aed);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    color: white;
  }

  .creative-form {
    background: white;
    padding: 60px 40px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
  }

  .form-container {
    max-width: 450px;
    margin: 0 auto;
    width: 100%;
  }

  .form-header {
    text-align: center;
    margin-bottom: 40px;
  }

  .form-title {
    font-size: 36px;
    font-weight: 700;
    color: #1e293b;
    margin-bottom: 10px;
  }

  .form-subtitle {
    color: #64748b;
    font-size: 16px;
  }

  .floating-form-group {
    position: relative;
    margin-bottom: 30px;
  }

  .floating-input {
    width: 100%;
    padding: 24px 20px 12px;
    font-size: 16px;
    background: #f8fafc;
    border: 2px solid transparent;
    border-radius: 12px;
    transition: all 0.3s ease;
    color: #1e293b;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }

  .floating-input:focus {
    outline: none;
    border-color: #2563eb;
    background: white;
    box-shadow: 0 10px 25px rgba(37, 99, 235, 0.15);
    transform: translateY(-2px);
  }

  .floating-label {
    position: absolute;
    left: 20px;
    top: 18px;
    color: #64748b;
    font-size: 16px;
    pointer-events: none;
    transition: all 0.3s ease;
    background: transparent;
    padding: 0 5px;
  }

  .floating-input:focus + .floating-label,
  .floating-input:not(:placeholder-shown) + .floating-label {
    top: 8px;
    font-size: 12px;
    color: #2563eb;
    font-weight: 600;
  }

  .input-icon {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    color: #94a3b8;
    font-size: 20px;
    transition: all 0.3s ease;
  }

  .floating-input:focus ~ .input-icon {
    color: #2563eb;
    transform: translateY(-50%) scale(1.2);
  }

  /* Phone with fixed +91 prefix */
  .phone-wrapper {
    position: relative;
  }

  .phone-prefix {
    position: absolute;
    left: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: #64748b;
    font-weight: 600;
    font-size: 16px;
    z-index: 2;
    pointer-events: none;
    background: #e5e7eb;
    padding: 16px 12px;
    border-radius: 12px 0 0 12px;
    border-right: 1px solid #d1d5db;
  }

  .phone-input {
    padding-left: 80px !important;
  }

  .creative-btn {
    width: 100%;
    padding: 20px;
    background: linear-gradient(135deg, #2563eb, #7c3aed);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
    margin-top: 10px;
    box-shadow: 0 10px 30px rgba(37, 99, 235, 0.3);
  }

  .creative-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 40px rgba(37, 99, 235, 0.4);
  }

  .creative-btn:active {
    transform: translateY(-1px);
  }

  .creative-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .btn-content {
    position: relative;
    z-index: 2;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .btn-shine {
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: linear-gradient(to right, transparent 0%, rgba(255, 255, 255, 0.3) 50%, transparent 100%);
    transform: rotate(30deg);
    transition: transform 0.6s;
  }

  .creative-btn:hover .btn-shine {
    transform: rotate(30deg) translateX(100%);
  }

  .creative-alert {
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 30px;
    display: flex;
    align-items: center;
    gap: 15px;
    animation: slideDown 0.5s ease;
    background: #f8fafc;
    border-left: 4px solid;
  }

  .creative-alert.success {
    border-left-color: #10b981;
    background: #f0fdf4;
  }

  .creative-alert.error {
    border-left-color: #ef4444;
    background: #fef2f2;
  }

  .alert-icon {
    font-size: 24px;
  }

  .error-message {
    color: #ef4444;
    font-size: 13px;
    margin-top: 6px;
    display: none;
  }

  .input-error .floating-input,
  .input-error .phone-input {
    border-color: #ef4444 !important;
    background: #fef2f2;
  }

  .input-error .error-message {
    display: block;
  }

  @keyframes slideDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .stats-counter {
    display: flex;
    justify-content: space-around;
    margin-top: 40px;
    padding: 20px;
    background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
    border-radius: 16px;
  }

  .stat-item {
    text-align: center;
  }

  .stat-number {
    font-size: 32px;
    font-weight: 700;
    background: linear-gradient(135deg, #2563eb, #7c3aed);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    display: block;
    line-height: 1;
  }

  .stat-label {
    font-size: 12px;
    color: #64748b;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-top: 5px;
  }

  @media (max-width: 1024px) {
    .creative-container { grid-template-columns: 1fr; }
    .creative-visual { padding: 40px 20px; text-align: center; align-items: center; }
  }

  @media (max-width: 640px) {
    .creative-visual, .creative-form { padding: 30px 20px; }
    .visual-title { font-size: 36px; }
    .form-title { font-size: 28px; }
    .stats-counter { flex-direction: column; gap: 20px; }
  }

  .particles {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 1;
  }

  .particle {
    position: absolute;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    animation: float 20s infinite linear;
  }

  @keyframes float {
    0% { transform: translateY(0) rotate(0deg); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(-1000px) rotate(720deg); opacity: 0; }
  }
</style>

<div class="creative-container">
  <!-- Left Visual Side -->
  <div class="creative-visual">
    <div class="visual-overlay"></div>
    <div class="particles" id="particles"></div>
    
    <div class="visual-content">
      <h1 class="visual-title">
        Stay Ahead of the Curve<br>with Smart Alerts
      </h1>
      <p class="visual-subtitle">
        Join thousands of people who receive timely emergency notifications, disaster updates, and safety alerts in their area.
      </p>
      
      <div class="features-list">
        <div class="feature-item">
          <div class="feature-icon"><i class="fas fa-bolt"></i></div>
          <div>
            <strong>Real-time Notifications</strong>
            <p style="margin: 5px 0 0; font-size: 14px; color: #94a3b8;">Instant alerts when it matters most</p>
          </div>
        </div>
        
        <div class="feature-item">
          <div class="feature-icon"><i class="fas fa-map-marked-alt"></i></div>
          <div>
            <strong>Location-Based</strong>
            <p style="margin: 5px 0 0; font-size: 14px; color: #94a3b8;">Alerts relevant to your city/area</p>
          </div>
        </div>
        
        <div class="feature-item">
          <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
          <div>
            <strong>Secure & Private</strong>
            <p style="margin: 5px 0 0; font-size: 14px; color: #94a3b8;">Your data is fully encrypted</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right Form Side -->
  <div class="creative-form">
    <div class="form-container">
      <div class="form-header">
        <h2 class="form-title">Register Now</h2>
        <p class="form-subtitle">Get instant emergency & safety alerts</p>
      </div>

      {% if error %}
      <div class="creative-alert error">
        <i class="fas fa-exclamation-circle alert-icon"></i>
        <div>{{ error }}</div>
      </div>
      {% endif %}
      
      {% if message %}
      <div class="creative-alert success">
        <i class="fas fa-check-circle alert-icon"></i>
        <div>{{ message }}</div>
      </div>
      {% endif %}

      <form method="POST" id="registerForm" novalidate enctype="application/x-www-form-urlencoded">
        <div class="floating-form-group">
          <input 
            type="email" 
            class="floating-input" 
            id="email" 
            name="email" 
            placeholder=" " 
            required 
            autocomplete="email"
            value="{{ request.form.email or '' }}"
          >
          <label class="floating-label">Email Address</label>
          <i class="fas fa-envelope input-icon"></i>
          <div class="error-message" id="emailError">Email is required</div>
        </div>

        <div class="floating-form-group phone-wrapper">
          <span class="phone-prefix">+91</span>
          <input 
              type="tel" 
              class="floating-input phone-input" 
              id="phone" 
              name="phone" 
              placeholder=" " 
              required 
              pattern="[0-9]{10}" 
              maxlength="10"
              inputmode="numeric"
              title="Please enter a valid 10-digit phone number (without +91)"
              autocomplete="tel-national"
              value="{{ request.form.phone or '' }}"
          >
          <label class="floating-label">Phone Number (10 digits)</label>
          <i class="fas fa-phone input-icon"></i>
          <div class="error-message" id="phoneError">Enter exactly 10 digits</div>
        </div>

        <div class="floating-form-group">
          <input 
            type="text" 
            class="floating-input" 
            id="location" 
            name="location" 
            placeholder=" " 
            required 
            autocomplete="address-level2"
            value="{{ request.form.location or '' }}"
          >
          <label class="floating-label">Your Location (City / Area)</label>
          <i class="fas fa-map-marker-alt input-icon"></i>
          <div class="error-message" id="locationError">Location is required</div>
        </div>

        <button type="submit" class="creative-btn" id="submitBtn">
          <span class="btn-shine"></span>
          <span class="btn-content">
            <i class="fas fa-paper-plane"></i>
            <span>Start Receiving Alerts</span>
          </span>
        </button>

        <div class="stats-counter">
          <div class="stat-item">
            <span class="stat-number" id="userCount">25K+</span>
            <span class="stat-label">Active Users</span>
          </div>
          <div class="stat-item">
            <span class="stat-number" id="alertCount">1.2M+</span>
            <span class="stat-label">Alerts Sent</span>
          </div>
          <div class="stat-item">
            <span class="stat-number" id="responseCount">98%</span>
            <span class="stat-label">Response Rate</span>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
// Create floating particles
function createParticles() {
  const container = document.getElementById('particles');
  const particleCount = 30;
  
  for (let i = 0; i < particleCount; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    
    const size = Math.random() * 10 + 2;
    const posX = Math.random() * 100;
    const duration = Math.random() * 20 + 10;
    const delay = Math.random() * 20;
    
    particle.style.width = `${size}px`;
    particle.style.height = `${size}px`;
    particle.style.left = `${posX}%`;
    particle.style.animationDuration = `${duration}s`;
    particle.style.animationDelay = `${delay}s`;
    
    container.appendChild(particle);
  }
}

// Animated counter
function animateCounter(id, target, suffix = '') {
  const element = document.getElementById(id);
  let current = parseInt(element.textContent.replace(/[^0-9]/g, '')) || 0;
  const increment = Math.ceil((target - current) / 50);
  
  const timer = setInterval(() => {
    current += increment;
    if (current >= target) {
      current = target;
      clearInterval(timer);
    }
    element.textContent = suffix ? `${current.toLocaleString()}${suffix}` : current;
  }, 30);
}

// Real-time form validation
function validateForm() {
  let isValid = true;

  // Email
  const emailInput = document.getElementById('email');
  const emailError = document.getElementById('emailError');
  if (!emailInput.value.trim()) {
    emailError.textContent = "Email is required";
    emailInput.parentElement.classList.add('input-error');
    isValid = false;
  } else if (!emailInput.value.includes('@') || !emailInput.value.includes('.')) {
    emailError.textContent = "Please enter a valid email";
    emailInput.parentElement.classList.add('input-error');
    isValid = false;
  } else {
    emailError.textContent = "";
    emailInput.parentElement.classList.remove('input-error');
  }

  // Phone
 // Phone validation - handle +91 prefix correctly
  const phoneInput = document.getElementById('phone');
  const phoneError = document.getElementById('phoneError');
  const phoneVal = phoneInput.value.trim();

  if (!phoneVal) {
      phoneError.textContent = "Phone number is required";
      phoneInput.parentElement.classList.add('input-error');
      isValid = false;
  } else if (!/^\d{10}$/.test(phoneVal)) {
      phoneError.textContent = "Enter exactly 10 digits (without +91)";
      phoneInput.parentElement.classList.add('input-error');
      isValid = false;
  } else {
      phoneError.textContent = "";
      phoneInput.parentElement.classList.remove('input-error');
  }

  // Location
  const locationInput = document.getElementById('location');
  const locationError = document.getElementById('locationError');
  if (!locationInput.value.trim()) {
    locationError.textContent = "Location is required";
    locationInput.parentElement.classList.add('input-error');
    isValid = false;
  } else {
    locationError.textContent = "";
    locationInput.parentElement.classList.remove('input-error');
  }

  return isValid;
}

// Prevent submit if invalid
document.getElementById('registerForm').addEventListener('submit', function(e) {
  if (!validateForm()) {
    e.preventDefault();
    return false;
  }

  const submitBtn = document.getElementById('submitBtn');
  const originalContent = submitBtn.innerHTML;
  
  submitBtn.innerHTML = `
    <div class="btn-content">
      <i class="fas fa-circle-notch fa-spin"></i>
      <span>Processing...</span>
    </div>
  `;
  submitBtn.disabled = true;
  submitBtn.style.opacity = '0.8';
  submitBtn.style.cursor = 'not-allowed';
});

// Real-time validation on input
document.querySelectorAll('.floating-input, .phone-input').forEach(input => {
  input.addEventListener('input', validateForm);
  input.addEventListener('blur', validateForm);
});

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  createParticles();
  
  setTimeout(() => animateCounter('userCount', 25000, '+'), 500);
  setTimeout(() => animateCounter('alertCount', 1200000, '+'), 800);
  setTimeout(() => animateCounter('responseCount', 98, '%'), 1100);
  
  const features = document.querySelectorAll('.feature-item');
  features.forEach((feature, index) => {
    feature.style.transitionDelay = `${index * 100}ms`;
  });
});
</script>

{% endblock %}